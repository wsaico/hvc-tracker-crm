# üèóÔ∏è Arquitectura Modular - HVC Tracker CRM

## üìã Tabla de Contenidos
- [Visi√≥n General](#visi√≥n-general)
- [Arquitectura del Sistema](#arquitectura-del-sistema)
- [M√≥dulos Implementados](#m√≥dulos-implementados)
- [Buenas Pr√°cticas Aplicadas](#buenas-pr√°cticas-aplicadas)
- [Patrones de Dise√±o](#patrones-de-dise√±o)
- [Flujo de Datos](#flujo-de-datos)
- [Escalabilidad y Mantenibilidad](#escalabilidad-y-mantenibilidad)

---

## üéØ Visi√≥n General

El **HVC Tracker CRM** ha sido desarrollado siguiendo principios SOLID y buenas pr√°cticas de programaci√≥n modular. La aplicaci√≥n est√° estructurada en m√≥dulos independientes y cohesivos que facilitan el mantenimiento, escalabilidad y testing.

### Caracter√≠sticas Arquitect\u00f3nicas Clave:
- ‚úÖ **Separaci√≥n de Responsabilidades** (SRP - Single Responsibility Principle)
- ‚úÖ **M√≥dulos Desacoplados** (Dependency Inversion)
- ‚úÖ **Gesti√≥n Centralizada de Estado** (State Management Pattern)
- ‚úÖ **Validaciones y Sanitizaci√≥n** (Security Best Practices)
- ‚úÖ **Manejo de Errores Robusto** (Error Handling)
- ‚úÖ **Documentaci√≥n JSDoc** (Self-Documenting Code)
- ‚úÖ **Constantes y Enums** (Magic Numbers Elimination)

---

## üèõÔ∏è Arquitectura del Sistema

La aplicaci√≥n sigue una arquitectura **modular en capas**:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    PRESENTACI√ìN                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇUIComponents‚îÇ  ‚îÇ   Views    ‚îÇ  ‚îÇ  Templates ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚Üï
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 L√ìGICA DE NEGOCIO                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ BusinessLogic  ‚îÇ  ‚îÇ  RecommendationEngine    ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚Üï
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 CAPA DE SERVICIOS                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ ApiService ‚îÇ  ‚îÇ Validators ‚îÇ  ‚îÇ   Utils    ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚Üï
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  GESTI√ìN DE ESTADO                   ‚îÇ
‚îÇ              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                  ‚îÇ
‚îÇ              ‚îÇ   StateManager     ‚îÇ                  ‚îÇ
‚îÇ              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚Üï
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ               CAPA DE DATOS (SUPABASE)               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ  Airports  ‚îÇ  ‚îÇ Passengers ‚îÇ  ‚îÇInteractions‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üì¶ M√≥dulos Implementados

### 1. **CONSTANTS** - Constantes y Enumeraciones
```javascript
const CONSTANTS = Object.freeze({ ... });
```

**Responsabilidad**: Centralizar todos los valores constantes de la aplicaci√≥n.

**Ventajas**:
- ‚úÖ Elimina "magic strings" y "magic numbers"
- ‚úÖ Facilita cambios globales
- ‚úÖ Previene errores de tipeo
- ‚úÖ Mejora la legibilidad del c√≥digo

**Contenido**:
- Categor√≠as HVC (SIGNATURE, TOP, BLACK, etc.)
- Estatus de vuelos
- Motivos de viaje
- Servicios disponibles
- Roles de usuario
- Vistas del sistema
- Tipos de notificaciones
- Umbrales de Medallia

---

### 2. **Config** - Configuraci√≥n de la Aplicaci√≥n
```javascript
const Config = (() => {
    let supabaseClient = null;

    const initSupabase = () => { ... };
    const getSupabaseClient = () => { ... };

    return { initSupabase, getSupabaseClient };
})();
```

**Responsabilidad**: Gestionar la configuraci√≥n y conexi√≥n con servicios externos.

**Patr√≥n**: **Singleton Pattern** + **Module Pattern**

**Ventajas**:
- ‚úÖ Una √∫nica instancia de Supabase Client
- ‚úÖ Lazy initialization
- ‚úÖ Encapsulaci√≥n de credenciales

---

### 3. **StateManager** - Gesti√≥n del Estado
```javascript
const StateManager = (() => {
    let state = { ... };
    const listeners = [];

    const getState = () => ({ ...state });
    const setState = (updates) => { ... };
    const resetState = () => { ... };
    const subscribe = (callback) => { ... };

    return { getState, setState, resetState, subscribe };
})();
```

**Responsabilidad**: Gesti√≥n centralizada del estado de la aplicaci√≥n.

**Patr√≥n**: **Observer Pattern** + **Immutability**

**Ventajas**:
- ‚úÖ Fuente √∫nica de verdad (Single Source of Truth)
- ‚úÖ Estado inmutable (no se modifica directamente)
- ‚úÖ Reactividad mediante observers
- ‚úÖ Facilita debugging y testing

**Estado Gestionado**:
- `currentUser`: Usuario logueado
- `currentRole`: Rol (supervisor/agente)
- `currentAirport`: Aeropuerto activo
- `currentView`: Vista actual
- `selectedPassenger`: Pasajero seleccionado
- `flights`, `passengers`, `interactions`, `airports`: Datos cacheados

---

### 4. **Validators** - Validaciones de Datos
```javascript
const Validators = (() => {
    const isValidCategory = (category) => { ... };
    const isValidFlightStatus = (status) => { ... };
    const validateManifestLine = (line) => { ... };
    const isValidMedalliaScore = (score) => { ... };
    const sanitizeText = (text) => { ... };

    return { ... };
})();
```

**Responsabilidad**: Validaci√≥n y sanitizaci√≥n de datos de entrada.

**Ventajas**:
- ‚úÖ Prevenci√≥n de XSS (Cross-Site Scripting)
- ‚úÖ Validaci√≥n consistente en toda la app
- ‚úÖ Mensajes de error descriptivos
- ‚úÖ Reutilizaci√≥n de validaciones

**Validaciones Implementadas**:
- Categor√≠as HVC v√°lidas
- Estatus de vuelos v√°lidos
- Formato del manifiesto
- Calificaciones Medallia (1-10)
- Sanitizaci√≥n anti-XSS

---

### 5. **Utils** - Utilidades Generales
```javascript
const Utils = (() => {
    const formatDate = (date) => { ... };
    const formatDateTime = (date) => { ... };
    const getCategoryClass = (categoria) => { ... };
    const getBadgeClass = (categoria) => { ... };
    const getMedalliaColor = (score) => { ... };
    const getMedalliaText = (score) => { ... };
    const isBirthday = (fechaNacimiento) => { ... };
    const calculateAge = (fechaNacimiento) => { ... };
    const showNotification = (message, type) => { ... };
    const calculateDateRange = (period) => { ... };

    return { ... };
})();
```

**Responsabilidad**: Funciones de utilidad reutilizables.

**Principio**: **DRY (Don't Repeat Yourself)**

**Ventajas**:
- ‚úÖ Evita duplicaci√≥n de c√≥digo
- ‚úÖ Funciones puras (sin side effects)
- ‚úÖ F√°cil de testear
- ‚úÖ Formato consistente en toda la app

---

### 6. **ApiService** - Comunicaci√≥n con Backend
```javascript
const ApiService = (() => {
    const client = Config.getSupabaseClient();

    const handleError = (operation, error) => { ... };

    // Airports
    const getAirports = async () => { ... };
    const createAirport = async (nombre, codigo) => { ... };

    // Passengers
    const getPassenger = async (dniPasaporte, aeropuertoId) => { ... };
    const createPassenger = async (passengerData) => { ... };
    const searchPassengers = async (query, aeropuertoId) => { ... };

    // Flights
    const createFlight = async (flightData) => { ... };
    const addPassengerToFlight = async (...) => { ... };

    // Interactions
    const createInteraction = async (interactionData) => { ... };
    const getPassengerInteractions = async (pasajeroId) => { ... };

    return { ... };
})();
```

**Responsabilidad**: Abstracci√≥n de la comunicaci√≥n con Supabase.

**Patr√≥n**: **Repository Pattern** + **Service Layer**

**Ventajas**:
- ‚úÖ Centralizaci√≥n de l√≥gica de acceso a datos
- ‚úÖ Manejo consistente de errores
- ‚úÖ Abstracci√≥n de Supabase (f√°cil cambiar backend)
- ‚úÖ Separaci√≥n de concerns

**Funcionalidades**:
- CRUD completo para todas las entidades
- Queries optimizadas con joins
- Manejo de errores centralizado
- Logging de operaciones

---

### 7. **BusinessLogic** - L√≥gica de Negocio
```javascript
const BusinessLogic = (() => {
    const generateRecommendations = (passenger, interactions) => { ... };
    const parseManifest = (manifestText) => { ... };
    const processManifest = async (manifestData, flightDate, aeropuertoId) => { ... };
    const calculateDashboardMetrics = (interactions, passengers) => { ... };

    return { ... };
})();
```

**Responsabilidad**: L√≥gica de negocio compleja de la aplicaci√≥n.

**Principio**: **Business Logic Segregation**

**Ventajas**:
- ‚úÖ Separaci√≥n clara entre l√≥gica de negocio y presentaci√≥n
- ‚úÖ Reglas de negocio centralizadas
- ‚úÖ F√°cil de testear unitariamente
- ‚úÖ Reutilizable

**Funcionalidades**:
- Motor de recomendaciones inteligentes
- Parseo y validaci√≥n de manifiestos
- C√°lculo de m√©tricas y KPIs
- Detecci√≥n de pasajeros en riesgo

---

### 8. **UIComponents** - Componentes de UI
```javascript
const UIComponents = (() => {
    const renderLogin = () => { ... };
    const renderNavbar = () => { ... };
    const renderManifest = () => { ... };
    const renderPassengerSearch = () => { ... };
    const renderDashboard = () => { ... };

    return { ... };
})();
```

**Responsabilidad**: Generaci√≥n de HTML para componentes de interfaz.

**Patr√≥n**: **Component Pattern** + **Template Literals**

**Ventajas**:
- ‚úÖ Componentes reutilizables
- ‚úÖ Separaci√≥n de l√≥gica y presentaci√≥n
- ‚úÖ F√°cil mantenimiento de UI
- ‚úÖ Consistencia visual

---

### 9. **App** - Controlador Principal
```javascript
const App = (() => {
    const init = async () => { ... };
    const changeView = (view) => { ... };
    const logout = () => { ... };
    const render = async () => { ... };
    const setupLoginHandlers = async () => { ... };

    return { init, changeView, logout };
})();
```

**Responsabilidad**: Orquestaci√≥n de la aplicaci√≥n.

**Patr√≥n**: **MVC Controller** + **Facade Pattern**

**Ventajas**:
- ‚úÖ Punto de entrada √∫nico
- ‚úÖ Coordina todos los m√≥dulos
- ‚úÖ Gesti√≥n del ciclo de vida de la app
- ‚úÖ Routing de vistas

---

## üé® Buenas Pr√°cticas Aplicadas

### 1. **Principios SOLID**

#### S - Single Responsibility Principle
Cada m√≥dulo tiene una √∫nica responsabilidad:
- `ApiService`: Solo comunicaci√≥n con backend
- `Validators`: Solo validaciones
- `Utils`: Solo utilidades generales
- `BusinessLogic`: Solo l√≥gica de negocio

#### O - Open/Closed Principle
Los m√≥dulos est√°n abiertos para extensi√≥n pero cerrados para modificaci√≥n.
- Agregar nueva validaci√≥n: extender `Validators` sin modificar existentes
- Agregar nueva utilidad: extender `Utils` sin modificar existentes

#### L - Liskov Substitution Principle
Las funciones son consistentes con sus contratos.

#### I - Interface Segregation Principle
Cada m√≥dulo expone solo las funciones necesarias.

#### D - Dependency Inversion Principle
Los m√≥dulos de alto nivel (`App`) no dependen de detalles de implementaci√≥n sino de abstracciones (`ApiService`, `BusinessLogic`).

---

### 2. **Seguridad**

```javascript
// Sanitizaci√≥n anti-XSS
const sanitizeText = (text) => {
    if (!text) return '';
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
};

// Validaciones estrictas
const isValidCategory = (category) => {
    return Object.values(CONSTANTS.CATEGORIES).includes(category.toUpperCase());
};
```

**Implementaciones de Seguridad**:
- ‚úÖ Sanitizaci√≥n de inputs contra XSS
- ‚úÖ Validaci√≥n estricta de datos
- ‚úÖ Row Level Security (RLS) en Supabase
- ‚úÖ No exposici√≥n de claves sensibles
- ‚úÖ Prevenci√≥n de inyecci√≥n SQL (Supabase ORM)

---

### 3. **Manejo de Errores**

```javascript
const handleError = (operation, error) => {
    console.error(`Error en ${operation}:`, error);
    Utils.showNotification(
        `Error: ${operation}. ${error.message}`,
        CONSTANTS.NOTIFICATION_TYPES.ERROR
    );
    throw error;
};
```

**Estrategia de Manejo de Errores**:
- ‚úÖ Logging centralizado
- ‚úÖ Notificaciones al usuario
- ‚úÖ Graceful degradation
- ‚úÖ Mensajes de error descriptivos

---

### 4. **Inmutabilidad**

```javascript
// Estado inmutable
const getState = () => ({ ...state }); // Retorna copia, no referencia

const setState = (updates) => {
    state = { ...state, ...updates }; // Crea nuevo objeto
    notifyListeners();
};
```

**Ventajas**:
- ‚úÖ Previene mutaciones inesperadas
- ‚úÖ Facilita debugging
- ‚úÖ Predecible comportamiento

---

### 5. **Documentaci√≥n JSDoc**

```javascript
/**
 * Obtiene un pasajero por DNI/Pasaporte
 * @param {string} dniPasaporte - DNI o pasaporte
 * @param {string} aeropuertoId - ID del aeropuerto
 * @returns {Promise<Object|null>} Pasajero o null
 */
const getPassenger = async (dniPasaporte, aeropuertoId) => { ... };
```

**Ventajas**:
- ‚úÖ C√≥digo auto-documentado
- ‚úÖ IntelliSense en IDEs modernos
- ‚úÖ Contratos de funci√≥n claros
- ‚úÖ Facilita onboarding de nuevos desarrolladores

---

## üîÑ Flujo de Datos

```
Usuario Interact√∫a
      ‚Üì
   UI Event
      ‚Üì
Event Handler (App)
      ‚Üì
BusinessLogic (Procesa)
      ‚Üì
Validators (Valida)
      ‚Üì
ApiService (Persiste)
      ‚Üì
Supabase Database
      ‚Üì
ApiService (Recupera)
      ‚Üì
StateManager (Actualiza)
      ‚Üì
UIComponents (Renderiza)
      ‚Üì
Usuario Ve Resultado
```

---

## üìà Escalabilidad y Mantenibilidad

### Agregar Nueva Funcionalidad

#### Ejemplo: Agregar nueva categor√≠a HVC

1. **CONSTANTS**: Agregar nueva categor√≠a
```javascript
CATEGORIES: Object.freeze({
    ...
    DIAMOND: 'DIAMOND' // Nueva categor√≠a
})
```

2. **CSS**: Agregar estilos
```css
.categoria-diamond { background: linear-gradient(...); }
.badge-diamond { background-color: #...; }
```

3. **Validators**: Autom√°ticamente v√°lida (usa Object.values())

4. **Listo!** El resto del sistema se adapta autom√°ticamente.

### Agregar Nuevo M√≥dulo

```javascript
const NewModule = (() => {
    // Encapsular l√≥gica privada
    let privateVar = null;

    // Exponer API p√∫blica
    const publicMethod = () => { ... };

    return {
        publicMethod
    };
})();
```

### Testing

Cada m√≥dulo es **independiente** y **testeable**:

```javascript
// Test de Validators
describe('Validators', () => {
    it('should validate category', () => {
        expect(Validators.isValidCategory('BLACK')).toBe(true);
        expect(Validators.isValidCategory('INVALID')).toBe(false);
    });
});

// Test de Utils
describe('Utils', () => {
    it('should calculate age', () => {
        const age = Utils.calculateAge('1990-01-01');
        expect(age).toBeGreaterThan(30);
    });
});
```

---

## üöÄ Mejoras Futuras Recomendadas

### 1. **TypeScript**
Migrar a TypeScript para type safety:
```typescript
interface Passenger {
    id: string;
    nombre: string;
    categoria: CategoryType;
    // ...
}
```

### 2. **Web Components**
Convertir `UIComponents` a Web Components nativos:
```javascript
class PassengerCard extends HTMLElement {
    connectedCallback() { ... }
}
customElements.define('passenger-card', PassengerCard);
```

### 3. **Service Workers**
Implementar PWA con offline support:
```javascript
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js');
}
```

### 4. **Testing Suite**
Agregar Jest + Testing Library:
```json
{
    "devDependencies": {
        "jest": "^29.0.0",
        "@testing-library/dom": "^9.0.0"
    }
}
```

### 5. **Build Process**
Agregar bundler (Vite/Webpack) para optimizaci√≥n:
```javascript
// vite.config.js
export default {
    build: {
        minify: 'terser',
        target: 'es2015'
    }
}
```

---

## üìö Conclusi√≥n

El **HVC Tracker CRM** est√° construido con:
- ‚úÖ **Arquitectura Modular** escalable y mantenible
- ‚úÖ **Buenas Pr√°cticas** de programaci√≥n
- ‚úÖ **Principios SOLID** aplicados
- ‚úÖ **C√≥digo Limpio** y auto-documentado
- ‚úÖ **Seguridad** robusta
- ‚úÖ **Manejo de Errores** robusto

Esta arquitectura permite:
- üéØ Desarrollo √°gil de nuevas funcionalidades
- üõ†Ô∏è Mantenimiento sencillo
- üß™ Testing eficiente
- üë• Colaboraci√≥n en equipo
- üìà Escalabilidad a largo plazo

---

**Desarrollado con** ‚ù§Ô∏è **siguiendo las mejores pr√°cticas de ingenier√≠a de software moderna.**
