{
  "permissions": {
    "allow": [
      "Bash(git commit -m \"$(cat <<''EOF''\nfix: Corregir lÃ³gica de cÃ¡lculo de pasajeros en Tracking (recuperados vs en riesgo)\n\nCambios Principales:\n\n1. PROBLEMA IDENTIFICADO:\n\n   La lÃ³gica anterior era demasiado restrictiva y con conflictos:\n   - \"Recuperados\" solo consideraba: detractor (â‰¤6) â†’ promotor (â‰¥9)\n   - Esto excluÃ­a recuperaciones de â‰¤6 a 7-8 (que tambiÃ©n son mejoras)\n   - Un pasajero podÃ­a aparecer en AMBAS listas simultÃ¡neamente\n   - Las cards no reflejaban la data real de las pruebas\n\n2. NUEVA LÃ“GICA IMPLEMENTADA:\n\n   PASAJEROS RECUPERADOS:\n   - Anterior: calificaciÃ³n â‰¤ 6 (detractor)\n   - Actual: calificaciÃ³n > 6 (mejorÃ³ a 7, 8, 9 o 10)\n   - Ejemplo: 5 â†’ 7 âœ“ | 6 â†’ 8 âœ“ | 4 â†’ 9 âœ“\n   - Ahora captura TODAS las recuperaciones reales\n\n   PASAJEROS EN RIESGO:\n   - Ãšltima calificaciÃ³n â‰¤ 6 (detractor)\n   - Y NO estÃ¡ en recuperados (son mutuamente excluyentes)\n   - Indica si tiene acciones de recuperaciÃ³n aplicadas\n\n   ESTADOS MUTUAMENTE EXCLUYENTES:\n   - Un pasajero solo puede estar en UNA categorÃ­a a la vez\n   - Prioridad: Si mejorÃ³ â†’ Recuperado | Si sigue bajo â†’ En riesgo\n\n3. CASOS CUBIERTOS:\n\n   Caso 1: Solo 1 interacciÃ³n con calificaciÃ³n baja (â‰¤6)\n   â†’ EN RIESGO âœ“\n\n   Caso 2: 2+ interacciones, Ãºltima es baja (â‰¤6)\n   â†’ EN RIESGO âœ“\n\n   Caso 3: 2+ interacciones, anterior baja (â‰¤6) y Ãºltima mejorÃ³ (>6)\n   â†’ RECUPERADO âœ“\n\n   Caso 4: 2+ interacciones, ambas buenas (>6)\n   â†’ Ni en riesgo ni recuperado (cliente satisfecho normal)\n\n4. BENEFICIOS:\n\n   âœ“ Refleja data real de las pruebas\n   âœ“ Captura todas las recuperaciones (no solo 6â†’9)\n   âœ“ Sin duplicados entre categorÃ­as\n   âœ“ LÃ³gica clara y predecible\n   âœ“ MÃ©tricas precisas\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git commit -m \"$(cat <<''EOF''\ndebug: Agregar console.log para investigar problema de pasajeros recuperados\n\nCambios Temporales para Debug:\n\n1. LOGS AGREGADOS:\n\n   - DEBUG de cada pasajero con mÃºltiples interacciones:\n     * Nombre del pasajero\n     * NÃºmero de interacciones\n     * Array completo de fechas y ratings\n     * CalificaciÃ³n anterior vs actual\n     * Booleano si cumple condiciÃ³n de recuperado\n\n   - LOG cuando se detecta un pasajero recuperado:\n     * \"âœ… RECUPERADO detectado: [nombre] [rating_anterior] â†’ [rating_actual]\"\n\n   - RESUMEN final del tracking:\n     * Total pasajeros\n     * Total interacciones\n     * Cantidad en riesgo\n     * Cantidad recuperados\n     * Cantidad cumpleaÃ±os\n     * Cantidad recientes 24h\n\n   - LISTAS de nombres:\n     * âœ… Pasajeros recuperados\n     * âš ï¸ Pasajeros en riesgo\n\n2. OBJETIVO:\n\n   Estos logs ayudarÃ¡n a identificar:\n   - Si las interacciones estÃ¡n en el orden correcto\n   - Si los ratings se estÃ¡n comparando correctamente\n   - Por quÃ© \"recuperados\" muestra 0 cuando deberÃ­a haber al menos 1\n   - Por quÃ© \"HOY\" muestra 4 cuando solo hay 1 pasajero\n\n3. INSTRUCCIONES PARA EL USUARIO:\n\n   Abrir consola del navegador (F12) y revisar:\n   - Buscar \"DEBUG Pasajero:\" para ver cada pasajero analizado\n   - Buscar \"âœ… RECUPERADO detectado\" para confirmar detecciones\n   - Buscar \"ðŸ“Š RESUMEN TRACKING\" para ver totales finales\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git commit -m \"$(cat <<''EOF''\ndebug: Mejorar logs con JSON.stringify para ver datos completos\n\nMejoras en Debug:\n\n1. Cambio de console.log de Object a JSON.stringify:\n   - Ahora los objetos se muestran completos en la consola\n   - Formato indentado para mejor lectura\n   - Se ven todos los valores, no solo \"[Object]\"\n\n2. Logs adicionales:\n   - Total de pasajeros con interacciones\n   - Nombre y cantidad de interacciones de cada pasajero\n   - Condiciones individuales evaluadas (para ver cuÃ¡l falla)\n\n3. InformaciÃ³n detallada por pasajero:\n   - previousRatingExiste\n   - previousRatingMenorIgual6\n   - latestRatingMayor6\n   - esRecuperado (resultado final)\n\nEsto ayudarÃ¡ a identificar exactamente quÃ© condiciÃ³n no se cumple.\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git commit -m \"$(cat <<''EOF''\nfix: Corregir bÃºsqueda de calificaciÃ³n anterior ignorando interacciones sin rating\n\nCambios Principales:\n\n1. PROBLEMA IDENTIFICADO:\n\n   Cuando un pasajero tenÃ­a mÃºltiples interacciones y alguna sin calificaciÃ³n:\n   \n   Ejemplo:\n   - InteracciÃ³n 1 (mÃ¡s reciente): rating 9\n   - InteracciÃ³n 2: rating null âŒ (sin calificaciÃ³n)\n   - InteracciÃ³n 3: rating 9\n   - InteracciÃ³n 4 (mÃ¡s antigua): rating 5\n   \n   La lÃ³gica anterior tomaba interactions[1] (rating null) como \"anterior\"\n   Entonces: previousRating = null â†’ condiciÃ³n fallaba\n   Resultado: No detectaba recuperaciÃ³n de 5 â†’ 9\n\n2. SOLUCIÃ“N IMPLEMENTADA:\n\n   Nueva lÃ³gica con bucle for:\n   - Busca la PRIMERA interacciÃ³n anterior que tenga calificaciÃ³n vÃ¡lida\n   - Salta interacciones con rating null o undefined\n   - Ahora encuentra correctamente: anterior = 9 (index 2)\n   \n   CÃ³digo:\n   ```javascript\n   let previousRating = null;\n   for (let i = 1; i < interactions.length; i++) {\n       if (interactions[i].calificacion_medallia !== null) {\n           previousRating = interactions[i].calificacion_medallia;\n           break;\n       }\n   }\n   ```\n\n3. CASO REAL RESUELTO:\n\n   Pedro Ramos con 4 interacciones:\n   - [0] 2025-10-20 23:21 â†’ rating: 9 âœ…\n   - [1] 2025-10-20 17:19 â†’ rating: null (ignorado)\n   - [2] 2025-10-20 15:36 â†’ rating: 9 âœ… (anterior vÃ¡lida)\n   - [3] 2025-10-19 23:29 â†’ rating: 5 âœ…\n   \n   Antes: No detectaba recuperaciÃ³n\n   Ahora: Detecta 9 vs 9 (no recuperado porque ambas son buenas)\n   \n   Nota: Para ver recuperaciÃ³n real necesita:\n   - InteracciÃ³n antigua con rating â‰¤6\n   - InteracciÃ³n reciente con rating >6\n\n4. BENEFICIOS:\n\n   âœ“ Maneja correctamente interacciones sin calificaciÃ³n\n   âœ“ Encuentra la calificaciÃ³n anterior vÃ¡lida mÃ¡s cercana\n   âœ“ Detecta recuperaciones que antes fallaban\n   âœ“ MÃ¡s robusto ante datos incompletos\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git add:*)",
      "Bash(git commit:*)"
    ],
    "deny": [],
    "ask": []
  }
}
